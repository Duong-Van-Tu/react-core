import{e as H,f as O,g as U,h as W,b as D,r as c,i as J,br as Q,P as y,k as q,bs as Y,bt as ee,bu as te,j as o,c as e,R as x,q as v,t as F,B as b,v as $,u as ne,C as j,D as re,z as ae}from"./index-D7kYuqtd.js";import{M as se}from"./index-DbvvMLWa.js";import{F as g}from"./index-Cxldnjy_.js";import{I as C}from"./index-DAOf7p35.js";import{u as E}from"./loading.hook-B4xO64Zi.js";import{d as ie}from"./dayjs.min-SzvlDAgD.js";import{T as le}from"./table-CK0VyuD-.js";import{S as oe}from"./search-8bG-27XG.js";import{L as N}from"./locale-formatter-FZ-3y9Y2.js";import"./ExclamationCircleFilled-Bz7bDzj1.js";import"./InfoCircleFilled-CK2dnJYF.js";import"./index-DGwjM0Al.js";import"./index-DMzhYhmi.js";import"./index-BuPIgzdn.js";var w=(t=>(t.EditSupplier="Edit Supplier",t.DeleteSupplier="Delete Supplier",t.AddSupplier="Add Supplier",t))(w||{});const T=()=>{const t=H(""),n=O(),s=U(),l=W(),a=D(i=>i.auth.user),d=c.useCallback(async({pageIndex:i=y.PAGEINDEX,pageSize:p=y.PAGESIZE,textSearch:u,statusId:m,time:z=ie().year().toString(),roleType:h})=>{const I={PageIndex:i.toString(),PageSize:p.toString(),UserId:a==null?void 0:a.id,RoleId:a==null?void 0:a.applicationRoles[0].id,StatusId:m,Time:`1-1-${z}`,TextSearch:u,tenant:l,roleType:h},k=J(I),{data:K,succeeded:L}=await n(()=>t.post(`/Supplier/get-list-with-pagination?${k}`),{loadingKey:"get-supplier"});if(L){const{items:M,totalRecords:X,pageIndex:_,totalPages:Z,totalExtend:B}=K;s(Q({data:M,pagination:{pageIndex:_,totalRecords:X,totalPages:Z},totalExtend:B}))}},[n,t]),r=c.useCallback(async i=>{const p=q({...i});console.log("Payload for API: ",[{data:p}]);const{data:u,succeeded:m}=await n(()=>t.post(`/Supplier/add-or-update?tenant=${l}`,[{data:p}]),{loadingKey:"add-supplier"});return m?(s(Y(u[0])),m):!1},[t,n]),S=c.useCallback(async i=>{const p=i.join(","),u=`${a==null?void 0:a.id}?tenant=${l}`,{succeeded:m}=await n(()=>t.del(`/Supplier/delete-by-ids/${p}/${u}`),{loadingKey:"delete-supplier"});return m!==null&&m?(s(ee(i)),!0):!1},[t,n]),f=c.useCallback(async i=>{const p=q({...i}),{data:u,succeeded:m}=await n(()=>t.post(`/Supplier/add-or-update?tenant=${l}`,[{id:i.id,data:p}]),{loadingKey:"edit-supplier"});return m?(s(te(u[0])),m):!1},[t,n]);return{getAllSupplier:d,deleteSupplier:S,addKSupplier:r,updateSupplier:f}},ce=({closeModal:t})=>{const[n]=g.useForm(),{addKSupplier:s}=T(),[l]=E(["add-supplier",!1]),a=async r=>{const S={...r};await s(S)&&(n.resetFields(),t())},d=()=>{t()};return o(c.Fragment,{children:[e("h3",{css:de,children:"Thêm nhà cung cấp"}),o(g,{form:n,css:pe,name:"add-supplier",onFinish:a,layout:"vertical",children:[o(x,{gutter:[20,0],children:[e(v,{span:12,children:e(g.Item,{label:e("span",{css:A,children:"Mã NCC"}),name:"code",rules:[{required:!0,message:"Vui lòng nhập mã NCC!"}],children:e(C,{placeholder:"Nhập mã NCC"})})}),e(v,{span:12,children:e(g.Item,{label:e("span",{css:A,children:"Tên NCC"}),name:"name",rules:[{required:!0,message:"Vui lòng nhập tên NCC!"}],children:e(C,{placeholder:"Nhập tên NCC"})})})]}),e(g.Item,{label:e("span",{css:A,children:"Mô tả"}),name:"description",rules:[{required:!0,message:"Vui lòng nhập mô tả!"}],children:e(C,{placeholder:"Nhập mô tả"})}),e(g.Item,{label:e("span",{css:A,children:"Đánh giá"}),name:"review",rules:[{required:!0,message:"Vui lòng nhập đánh giá!"}],children:e(C.TextArea,{placeholder:"Nhập đánh giá"})}),e(x,{justify:"end",children:o(F,{children:[e(b,{onClick:d,children:"Huỷ"}),e(b,{loading:l,type:"primary",htmlType:"submit",children:"Xác nhận"})]})})]})]})},de={name:"x2l4rd",styles:"font-weight:500;font-size:2rem;line-height:2.2rem;margin-top:2rem"},pe={name:"1mnl6b",styles:".ant-form-item-required::before{display:none!important;}margin-top:2rem;padding:1rem"},A={name:"vu4egt",styles:"font-size:1.4rem;line-height:1.6rem;font-weight:500"},ue=({closeModal:t,supplierIds:n})=>{const{deleteSupplier:s,getAllSupplier:l}=T(),a=D(p=>{var u;return(u=p.category.supplier.pagination)==null?void 0:u.pageIndex})??0,[d]=E(["delete-supplier",!1]),r=$(),f=new URLSearchParams(r.search).get("tab");return o("div",{css:me,children:[e("h3",{css:he,children:"Đồng ý xoá các mục tiêu đã chọn?"}),e(x,{justify:"center",children:o(F,{children:[e(b,{onClick:()=>t(),children:"Huỷ"}),e(b,{loading:d,type:"primary",danger:!0,onClick:async()=>{await s(n)?(l({pageIndex:a||1,pageSize:y.PAGESIZE,roleType:f}),t()):console.error("Failed to delete supplier")},children:"Xoá"})]})})]})},me={name:"mjs9a",styles:"margin-top:2rem;padding:0 2rem"},he={name:"bmm6zl",styles:"font-size:1.8rem;line-height:2rem;text-align:center;margin-bottom:2.4rem;font-weight:500"},ge=({closeModal:t,data:n})=>{const[s]=g.useForm(),{updateSupplier:l}=T(),[a]=E(["edit-supplier",!1]),d=async S=>{const f={...S,id:n.id};await l(f)&&(s.resetFields(),t())},r=()=>{t()};return c.useEffect(()=>{s.setFieldsValue(n)},[n]),o(c.Fragment,{children:[e("h3",{css:Se,children:"Chỉnh sửa nhà cung cấp"}),o(g,{form:s,css:fe,name:"add-supplier",onFinish:d,layout:"vertical",children:[o(x,{gutter:[20,0],children:[e(v,{span:12,children:e(g.Item,{label:e("span",{css:P,children:"Mã NCC"}),name:"code",rules:[{required:!0,message:"Vui lòng nhập mã NCC!"}],children:e(C,{placeholder:"Nhập mã NCC"})})}),e(v,{span:12,children:e(g.Item,{label:e("span",{css:P,children:"Tên NCC"}),name:"name",rules:[{required:!0,message:"Vui lòng nhập tên NCC!"}],children:e(C,{placeholder:"Nhập tên NCC"})})})]}),e(g.Item,{label:e("span",{css:P,children:"Mô tả"}),name:"description",rules:[{required:!0,message:"Vui lòng nhập mô tả!"}],children:e(C,{placeholder:"Nhập mô tả"})}),e(g.Item,{label:e("span",{css:P,children:"Đánh giá"}),name:"review",rules:[{required:!0,message:"Vui lòng nhập đánh giá!"}],children:e(C.TextArea,{placeholder:"Nhập đánh giá"})}),e(x,{justify:"end",children:o(F,{children:[e(b,{onClick:r,children:"Huỷ"}),e(b,{loading:a,type:"primary",htmlType:"submit",children:"Xác nhận"})]})})]})]})},Se={name:"x2l4rd",styles:"font-weight:500;font-size:2rem;line-height:2.2rem;margin-top:2rem"},fe={name:"1mnl6b",styles:".ant-form-item-required::before{display:none!important;}margin-top:2rem;padding:1rem"},P={name:"vu4egt",styles:"font-size:1.4rem;line-height:1.6rem;font-weight:500"},V=c.createContext(void 0),G=()=>{const t=c.useContext(V);if(!t)throw new Error("useModalSupplier must be used within a ModalSupplierProvider");return t},ye=({children:t})=>{const[n,s]=c.useState(),[l,a]=c.useState(!1),d=(S,f,i)=>{s({modalName:S,data:f,supplierIds:i}),a(!0)},r=()=>{s(void 0),a(!1)};return o(V.Provider,{value:{openModal:d,closeModal:r},children:[t,o(se,{open:l,onCancel:r,footer:null,children:[(n==null?void 0:n.modalName)===w.EditSupplier&&e(ge,{closeModal:r,data:n.data}),(n==null?void 0:n.modalName)===w.DeleteSupplier&&e(ue,{closeModal:r,data:n.data,supplierIds:n.supplierIds}),(n==null?void 0:n.modalName)===w.AddSupplier&&e(ce,{closeModal:r})]})]})};function be({data:t}){const{openModal:n}=G(),{formatMessage:s}=ne(),l=d=>{switch(d){case 1:n(w.EditSupplier,t);break}},a=[{key:"1",label:e("span",{children:s({id:"dropdown.edit"})}),onClick:()=>l(1)}];return e(re,{menu:{items:a},placement:"bottomRight",children:e(b,{css:Ce,children:e(j,{type:"three-dot",width:16,height:18})})})}const Ce={name:"l2srbf",styles:"background:none;border:none;box-shadow:unset;padding:0"},Ie=[{title:e(N,{id:"table.column.supplierCode"}),dataIndex:"code",render:t=>t},{title:e(N,{id:"table.column.supplierFullName"}),dataIndex:"name",render:t=>t},{title:e(N,{id:"table.column.supplierDesc"}),dataIndex:"description",render:t=>t},{title:e(N,{id:"table.column.supplierReview"}),dataIndex:"review",render:t=>t},{title:"",dataIndex:"calculationMethod",fixed:"right",width:"6%",render:(t,n)=>e(be,{data:n})}];function we(){const[t,n]=c.useState(),{openModal:s}=G(),{getAllSupplier:l}=T(),[a]=E(["get-supplier",!0]),{data:d,pagination:r}=D(h=>h.category.supplier),S=$(),i=new URLSearchParams(S.search).get("tab"),p=({textSearch:h,time:I})=>{l({pageIndex:(r==null?void 0:r.pageIndex)??y.PAGEINDEX,pageSize:y.PAGESIZE,textSearch:h,time:I,roleType:i})},u=h=>{l({pageIndex:h,pageSize:y.PAGESIZE,roleType:i})},m={onChange:(h,I)=>{n(I.map(k=>k.id))}},z=()=>{s("Delete Supplier",void 0,t)};return c.useEffect(()=>{l({pageIndex:y.PAGEINDEX,pageSize:y.PAGESIZE,roleType:i})},[l,i]),o("div",{css:xe,children:[o(b,{onClick:()=>s("Add Supplier"),type:"primary",css:Ne,iconPosition:"start",size:"large",children:[e(j,{color:"#fff",width:16,height:16,type:"circle-plus"}),e("span",{children:"Thêm nhà cung cấp"})]}),e("div",{css:Ae,children:e(oe,{onSearch:p})}),e("div",{css:Pe,children:e(b,{disabled:!t,onClick:()=>z(),size:"large",danger:!0,children:"Xoá mục tiêu đã chọn"})}),e(le,{rowSelection:m,columns:Ie,dataSource:d,loading:a,rowKey:h=>h.id,onTableChange:h=>u(h),pagination:{current:r==null?void 0:r.pageIndex,pageSize:y.PAGESIZE,total:r==null?void 0:r.totalRecords,position:["bottomCenter"]},scroll:{x:1450}})]})}const xe={name:"bjn8wh",styles:"position:relative"},Ne={name:"1vjzj34",styles:"position:absolute;right:0;top:-9rem;background:#0070b8;display:flex;align-items:center;gap:0.2rem;&:hover{background:#0070b8!important;opacity:0.9;}"},Ae={name:"f2f29z",styles:"margin-top:2.6rem"},Pe={name:"vj2mbl",styles:"margin:1.1rem 0"};function Le(){const t=U();return c.useEffect(()=>{t(ae([{title:{vi_VN:"Danh mục",en_US:"Category"}},{title:{vi_VN:"Nhà cung cấp",en_US:"Supplier"}}]))},[t]),o(ye,{children:[e("h3",{css:ve,children:"Nhà cung cấp"}),o("div",{css:R,children:[e(j,{width:8,height:8,type:"dot"}),e("span",{children:e("span",{css:R,children:"10 nhà cung cấp"})})]}),e(we,{})]})}const ve={name:"9czw1u",styles:"font-size:2.4rem;line-height:2.8rem;font-weight:600;color:rgba(16, 24, 40, 1);margin-bottom:0.5rem"},R={name:"q29gn3",styles:"font-size:1.2rem;font-weight:500;line-height:1.8rem;color:rgba(84, 104, 129, 1)"};export{Le as default};
//# sourceMappingURL=index-rgxXuBDt.js.map
