import{u as w,a as Y,y as O,h as v,c as t,B as I,C as f,D as G,r as x,b as L,w as N,P as c,j as m,g as R,z as j}from"./index-D7kYuqtd.js";import{u as M,M as B}from"./index-D3YsrBAD.js";import{T as Z}from"./table-CK0VyuD-.js";import{L as d}from"./locale-formatter-FZ-3y9Y2.js";import{c as u}from"./modal.enum-Dk0fWDyJ.js";import{d as C}from"./dayjs.min-SzvlDAgD.js";import{M as H}from"./message-CTVHhzE_.js";import{c as y}from"./status.enum-khnHdRij.js";import{u as K}from"./opportunity.service-Z_MSTo0G.js";import{S as U}from"./search-8bG-27XG.js";import{u as X}from"./loading.hook-B4xO64Zi.js";import"./index-DbvvMLWa.js";import"./ExclamationCircleFilled-Bz7bDzj1.js";import"./InfoCircleFilled-CK2dnJYF.js";import"./index-Cxldnjy_.js";import"./index-DAOf7p35.js";import"./index-DcquuWwD.js";import"./index-Dnrrwy9u.js";import"./index-DGwjM0Al.js";import"./index-DMzhYhmi.js";import"./index-BuPIgzdn.js";function F({data:e}){const{openModal:o}=M(),{formatMessage:n}=w(),{isSaleDirector:s}=Y(),i=O(),p=v(),l=r=>{switch(r){case 1:o(u.AssignOpportunity,e);break;case 2:o(u.CloseOpportunity,e);break;case 3:o(u.Delete,e);break;case 4:o(u.CreateHistoryOpportunity);break}},h=[{key:"1",label:t("span",{children:n({id:"dropdown.edit"})}),onClick:()=>i(`/sales/opportunity/${e==null?void 0:e.id}?tenant=${p}`)},{key:"2",label:t("span",{children:n({id:"title.dropdown.opportunity.assignOpportunity"})}),onClick:()=>l(1)},{key:"3",label:t("span",{children:n({id:"title.dropdown.opportunity.updateOpportunity"})}),onClick:()=>i(`/sales/opportunity/history-opportunity/${e.id}?tenant=${p}`)},{key:"4",label:t("span",{children:n({id:"title.dropdown.opportunity.closeOpportunity"})}),onClick:()=>l(2)},{key:"5",label:t("span",{children:n({id:"title.dropdown.opportunity.resultReport"})}),onClick:()=>i(`/sales/opportunity/report-opportunity/${e.id}?tenant=${p}`)},{key:"6",label:t("span",{children:n({id:"dropdown.delete"})}),onClick:()=>l(3)}],g=[{key:"1",label:t("span",{children:n({id:"dropdown.edit"})}),onClick:()=>i(`/sales/opportunity/${e==null?void 0:e.id}?tenant=${p}`)},{key:"2",label:t("span",{children:n({id:"title.dropdown.opportunity.updateOpportunity"})}),onClick:()=>i(`/sales/opportunity/history-opportunity/${e.id}?tenant=${p}`)},{key:"3",label:t("span",{children:n({id:"title.dropdown.opportunity.closeOpportunity"})}),onClick:()=>l(2)},{key:"4",label:t("span",{children:n({id:"title.dropdown.opportunity.resultReport"})}),onClick:()=>i(`/sales/opportunity/report-opportunity/${e.id}?tenant=${p}`)},{key:"5",label:t("span",{children:n({id:"dropdown.delete"})}),onClick:()=>l(3)}];return t(G,{menu:{items:s?h:g},placement:"bottomRight",children:t(I,{css:V,children:t(f,{type:"three-dot",width:16,height:18})})})}const V={name:"l2srbf",styles:"background:none;border:none;box-shadow:unset;padding:0"},q=[{title:t(d,{id:"table.column.customers"}),dataIndex:"customerName"},{title:t(d,{id:"table.column.opportunity.customerNeeds"}),dataIndex:"need",render:e=>e},{title:t(d,{id:"table.column.opportunity.decisionMakers"}),dataIndex:"accountable"},{title:t(d,{id:"table.column.opportunity.budget"}),dataIndex:"budget",render:e=>e,width:"8%"},{title:t(d,{id:"table.column.opportunity.expectedTime"}),dataIndex:"estimatedTime",render:e=>C(e).format("DD/MM/YYYY")},{title:t(d,{id:"table.column.opportunity.technicalLeads"}),dataIndex:"technicalLead"},{title:t(d,{id:"table.column.opportunity.beneficiaries"}),dataIndex:"beneficiary",render:e=>e},{title:"Giá vốn dự kiến",dataIndex:"estimatedMoney"},{title:"Hoa hồng cho người tư vấn",dataIndex:"commissionMoney"},{title:"Đối thủ 1",dataIndex:"opponent1"},{title:"Đối thủ 1",dataIndex:"opponent2"},{title:"Chiến lược của AT&A",dataIndex:"strategy"},{title:"Lần tương tác gần nhất giữa AT&A và khách hàng ",dataIndex:"lastTimeInteract",render:e=>C(e).format("DD/MM/YYYY")},{title:"Đánh giá khả năng thắng",dataIndex:"winningOppotunity"},{title:"Trạng thái",align:"center",dataIndex:["opportunityStatus","name"],render:(e,o)=>{var s,i;let n;switch((s=o.opportunityStatus)==null?void 0:s.code){case y.Active:n="success";break;case y.OnHold:n="info";break;case y.Fail:case y.Close:n="error";break;default:n="warning"}return t(H,{hasBackground:!0,type:n,children:(i=o.opportunityStatus)==null?void 0:i.name})}},{title:"",dataIndex:"calculationMethod",fixed:"right",width:"6%",render:(e,o)=>t(F,{data:o})}];function Q(){const{openModal:e}=M(),{formatMessage:o}=w(),n=O(),{getAllOpportunity:s,getAllStatusOpportunity:i}=K(),[p,l]=x.useState(),[h,g]=X(["get-opportunity",!0],["status-opportunity",!0]),{pagination:r,status:E,data:T,totalExtend:A}=L(a=>a.sale.opportunity),{textSearch:S,time:D,statusId:$}=N(),P={onChange:(a,b)=>{l(b.map(k=>k.id))}},z=a=>{s({pageIndex:a,pageSize:c.PAGESIZE,textSearch:S?decodeURI(S).replace(/\+/g," "):void 0,time:D,statusId:$})},_=({textSearch:a,statusId:b,time:k})=>{s({pageIndex:(r==null?void 0:r.pageIndex)??c.PAGEINDEX,pageSize:c.PAGESIZE,textSearch:a,statusId:b,time:k})};return x.useEffect(()=>{s({pageIndex:c.PAGEINDEX,pageSize:c.PAGESIZE}),i()},[s,i]),m("div",{css:W,children:[t("h3",{css:tt,children:o({id:"title.document.opportunity"})}),m("div",{css:J,children:[t("span",{children:o({id:"title.document.opportunity"})}),t(f,{width:8,height:8,type:"dot"}),m("span",{children:[A??0," ",o({id:"title.document.opportunity"})]})]}),m(I,{onClick:()=>n(`add-opportunity?tenant=${v()}`),type:"primary",css:et,iconPosition:"start",size:"large",children:[t(f,{color:"#fff",width:16,height:16,type:"circle-plus"})," ",t("span",{children:"Thêm cơ hội"})]}),t("div",{css:nt,children:t(U,{onSearch:_,loadingStatus:g,status:E})}),t(I,{disabled:!p,onClick:()=>e(u.Delete,void 0,p),size:"middle",danger:!0,children:"Xoá cơ hội đã chọn"}),t(Z,{css:ot,rowSelection:P,columns:q,dataSource:T,loading:h,rowKey:a=>a.id,onTableChange:a=>z(a),pagination:{current:r==null?void 0:r.pageIndex,pageSize:c.PAGESIZE,total:r==null?void 0:r.totalRecords,position:["bottomCenter"]},scroll:{x:2500}})]})}const W={name:"bjn8wh",styles:"position:relative"},J={name:"1t3fva7",styles:"display:flex;align-items:center;gap:4px;font-size:1.4rem;line-height:1.8rem"},tt={name:"156m3vd",styles:"font-size:1.8rem;line-height:2.3rem;font-weight:600"},et={name:"1skuuz6",styles:"background:#0070b8;display:flex;align-items:center;gap:0.2rem;position:absolute;top:1.4rem;right:0;&:hover{background:#0070b8!important;opacity:0.9;}"},nt={name:"gjoxlq",styles:"margin:2.6rem 0"},ot={name:"f2f29z",styles:"margin-top:2.6rem"};function Ot(){const e=R();return x.useEffect(()=>{e(j([{title:{vi_VN:"Sale",en_US:"Sale"}},{title:{vi_VN:"Cơ hội",en_US:"Opportunity"}}]))},[e]),t(B,{children:t(Q,{})})}export{Ot as default};
//# sourceMappingURL=index-kHTQtA55.js.map
