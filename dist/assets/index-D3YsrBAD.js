import{M as U}from"./index-DbvvMLWa.js";import{u as M,b as C,r as c,j as a,c as e,S as E,t as w,B as f,R as I,P,q as j,x as B}from"./index-D7kYuqtd.js";import{F as m}from"./index-Cxldnjy_.js";import{u as A}from"./loading.hook-B4xO64Zi.js";import{u as F}from"./opportunity.service-Z_MSTo0G.js";import{I as D}from"./index-DAOf7p35.js";import{c as X}from"./status.enum-khnHdRij.js";import{D as $}from"./index-DcquuWwD.js";import{T as G}from"./index-Dnrrwy9u.js";import{d as R}from"./dayjs.min-SzvlDAgD.js";import{c as b}from"./modal.enum-Dk0fWDyJ.js";const L=({...i})=>{const{closeModal:t,data:p}=i,{formatMessage:n}=M(),{getAllSaleAndSupplier:l,assignSaleAndSupplier:u}=F(),[s]=m.useForm(),[y]=A(["getAllSaleAndSupplier-opportunity",!1]),r=C(h=>h.sale.opportunity.saleAndSupplier),o=c.useMemo(()=>r==null?void 0:r.map(h=>({label:h.userName,value:h.id})),[r]),g=()=>{},S=async h=>{const x={id:p.id,saleAndSupplierId:h.saleAndSupplierId};await u(x)&&(s.resetFields(),t())},O=()=>{t()};return c.useEffect(()=>{l()},[l]),a(c.Fragment,{children:[e("h3",{css:W,children:"Gán cơ hội cho Sale/NPP"}),a(m,{form:s,css:Z,name:"assign-opportunity",onFinish:S,layout:"vertical",children:[e(m.Item,{label:e("span",{css:J,children:n({id:"title.form.select"})}),name:"saleAndSupplierId",rules:[{required:!0,message:n({id:"form.input.require.selectCustomer"})}],children:e(E,{size:"large",placeholder:n({id:"title.form.selectCustomer"}),onChange:g,allowClear:!0,loading:y,options:o})}),e(I,{justify:"end",children:a(w,{children:[e(f,{onClick:O,children:"Huỷ"}),e(f,{type:"primary",htmlType:"submit",children:"Xác nhận"})]})})]})]})},Z={name:"snz50q",styles:".ant-form-item-required::before{display:none!important;}margin-top:2rem;padding:1rem 0"},W={name:"x2l4rd",styles:"font-weight:500;font-size:2rem;line-height:2.2rem;margin-top:2rem"},J={name:"1pi3rvi",styles:"font-size:1.4rem;line-height:1.6rem;font-weight:500;color:rgba(16, 24, 40, 1)"},K=({...i})=>{const{closeModal:t,data:p}=i,{formatMessage:n}=M(),{getAllSaleAndSupplier:l,updateStatusOpportunityById:u}=F(),[s]=m.useForm(),[y]=A(["edit-statusOpportunityById",!1]),r=C(d=>d.sale.opportunity.status),[o,g]=c.useState(),S=c.useMemo(()=>{var d;return((d=r==null?void 0:r.find(v=>v.id===o))==null?void 0:d.code)===X.Fail},[r,o]),O=c.useMemo(()=>r==null?void 0:r.map(d=>({label:d.name,value:d.id})),[r]),h=async d=>{var T,N;const v={id:p.id,applicationUserId:(T=p.applicationUser)==null?void 0:T.id,status:(N=r==null?void 0:r.find(Y=>Y.id===d.status))==null?void 0:N.code,reason:d.reason};await u(v)&&(s.resetFields(),t())},x=()=>{t()};return c.useEffect(()=>{l()},[l]),a(c.Fragment,{children:[e("h3",{css:V,children:"Đóng cơ hội"}),a(m,{form:s,css:Q,name:"close-opportunity",onFinish:h,layout:"vertical",children:[e(m.Item,{label:e("span",{css:k,children:n({id:"title.form.selectStatus"})}),name:"status",rules:[{required:!0,message:n({id:"form.input.require.selectStatus"})}],children:e(E,{size:"large",placeholder:n({id:"title.form.selectStatus"}),allowClear:!0,loading:y,options:O,onSelect:d=>g(d)})}),S&&e(m.Item,{label:e("span",{css:k,children:n({id:"title.form.reason"})}),name:"reason",rules:[{required:!0,message:n({id:"form.input.require.reason"})}],children:e(D.TextArea,{style:{resize:"none"},placeholder:n({id:"form.input.reason"})})}),e(I,{justify:"end",children:a(w,{children:[e(f,{onClick:x,children:"Huỷ"}),e(f,{type:"primary",htmlType:"submit",children:"Xác nhận"})]})})]})]})},Q={name:"snz50q",styles:".ant-form-item-required::before{display:none!important;}margin-top:2rem;padding:1rem 0"},V={name:"x2l4rd",styles:"font-weight:500;font-size:2rem;line-height:2.2rem;margin-top:2rem"},k={name:"1pi3rvi",styles:"font-size:1.4rem;line-height:1.6rem;font-weight:500;color:rgba(16, 24, 40, 1)"},_=({closeModal:i,opportunityIds:t,data:p})=>{const{deleteOpportunity:n,getAllOpportunity:l}=F(),u=C(r=>{var o;return(o=r.sale.kpi.pagination)==null?void 0:o.pageIndex})??0,[s]=A(["delete-opportunity",!1]);return a("div",{css:ee,children:[e("h3",{css:te,children:"Đồng ý xoá cơ hội đã chọn?"}),e(I,{justify:"center",children:a(w,{children:[e(f,{onClick:()=>i(),children:"Huỷ"}),e(f,{loading:s,type:"primary",danger:!0,onClick:async()=>{await n(p?[p.id]:t)&&(i(),(t==null?void 0:t.length)===P.PAGESIZE&&l({pageIndex:u-1||1,pageSize:P.PAGESIZE}))},children:"Xoá"})]})})]})},ee={name:"mjs9a",styles:"margin-top:2rem;padding:0 2rem"},te={name:"bmm6zl",styles:"font-size:1.8rem;line-height:2rem;text-align:center;margin-bottom:2.4rem;font-weight:500"},ne=({closeModal:i,data:t})=>{const{addHistoryOpportunity:p}=F(),{formatMessage:n}=M(),[l]=m.useForm(),u=C(o=>o.auth.user),[s]=A(["add-Opportunity",!1]),y=async o=>{const{goal:g,time:S}=o,O={...o,time:R(S).format("DD/MM/YYYY"),goal:g.toString(),opportunityId:t.id,applicationUserId:u==null?void 0:u.id};await p(O)&&(l.resetFields(),i())},r=()=>{i()};return a(c.Fragment,{children:[e("h3",{css:ie,children:"Thêm cập nhật cơ hội"}),a(m,{form:l,css:re,name:"add-historyOpportunity",onFinish:y,layout:"vertical",children:[e(m.Item,{label:e("span",{css:q,children:n({id:"title.form.target"})}),name:"goal",rules:[{required:!0,message:n({id:"form.input.require.target"})}],children:e(G,{css:z,size:"large",placeholder:n({id:"form.input.target"})})}),e(m.Item,{label:e("span",{css:q,children:n({id:"title.form.activity"})}),name:"activity",rules:[{required:!0,message:n({id:"form.input.require.activity"})}],children:e(D.TextArea,{placeholder:n({id:"form.input.activity"}),allowClear:!0})}),a(I,{gutter:[20,0],children:[e(j,{span:12,children:e(m.Item,{label:e("span",{css:q,children:n({id:"title.form.time"})}),name:"time",rules:[{required:!0,message:n({id:"form.input.require.time"})}],children:e($,{size:"large",css:z,format:["DD/MM/YYYY"],placeholder:"Nhập thời điểm"})})}),e(j,{span:12,children:e(m.Item,{label:e("span",{css:q,children:n({id:"title.form.result"})}),name:"result",rules:[{required:!0,message:n({id:"form.input.require.result"})}],children:e(D,{css:z,size:"large",placeholder:"Nhập kết quả"})})})]}),e(I,{justify:"end",css:se,children:a(w,{children:[e(f,{onClick:r,children:"Huỷ"}),e(f,{loading:s,type:"primary",htmlType:"submit",children:"Xác nhận"})]})})]})]})},re={name:"1mnl6b",styles:".ant-form-item-required::before{display:none!important;}margin-top:2rem;padding:1rem"},ie={name:"x2l4rd",styles:"font-weight:500;font-size:2rem;line-height:2.2rem;margin-top:2rem"},q={name:"vu4egt",styles:"font-size:1.4rem;line-height:1.6rem;font-weight:500"},z={name:"1d3w5wq",styles:"width:100%"},se={name:"akdqam",styles:"margin-top:1rem"},H=c.createContext(void 0),Oe=()=>{const i=c.useContext(H);if(!i)throw new Error("useOpportunityModal must be used within a ModalOpportunityProvider");return i},be=({children:i})=>{const[t,p]=c.useState(),[n,l]=c.useState(!1),u=(y,r,o)=>{p({modalName:y,data:r,opportunityIds:o}),l(!0)},s=()=>{p(void 0),l(!1)};return a(H.Provider,{value:{openModal:u,closeModal:s},children:[i,a(U,{css:oe(t==null?void 0:t.modalName),open:n,onCancel:s,footer:null,children:[(t==null?void 0:t.modalName)===b.AssignOpportunity&&e(L,{closeModal:s,data:t.data}),(t==null?void 0:t.modalName)===b.CloseOpportunity&&e(K,{closeModal:s,data:t.data}),(t==null?void 0:t.modalName)===b.Delete&&e(_,{closeModal:s,data:t.data,opportunityIds:t.opportunityIds}),(t==null?void 0:t.modalName)===b.CreateHistoryOpportunity&&e(ne,{closeModal:s,data:t.data})]})]})},oe=i=>B("width:",i===b.Delete?"40rem":"52rem","!important;","");export{be as M,Oe as u};
//# sourceMappingURL=index-D3YsrBAD.js.map
