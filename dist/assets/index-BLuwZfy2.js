import{u as ge,a as ye,b as le,g as re,c as _,r as p,d as fe,s as Ie,P as z,e as q,f as H,h as be,i as J,j as Pe,k as ke,l as Se,m as F,n as c,o as e,I as T,R as b,C as h,S as R,B as S,p as B,q as we,t as ce,v as ne,w as se,D as Ke,L as $,x as Te,T as Ce,y as xe,z as Ee,A as ze,E as qe}from"./index-Bakn7Zu-.js";import{M as Ne}from"./index-B85xVXIU.js";import{F as o}from"./index-BxD5BTBy.js";import{S as w}from"./status.enum-aM5KhW0K.js";import{D as ie}from"./index-s-JRt1VF.js";import{T as Y}from"./index-DlE2oBel.js";import{R as D}from"./role.enum-2GZE6esB.js";import{M as $e}from"./message-BaT4kEws.js";var P=(i=>(i.EditKPI="Edit KPI",i.AddKPI="Add KPI",i.ModifyKPI="Modify KPI",i.FinalizeKPI="Finalize KPI",i.DeleteKPI="Delete KPI",i.ReviewEdit="Review edit",i.RequestEdit="Request edit",i.Report="Report",i.UpdateRequest="Update request",i))(P||{});const N=()=>{const i=ge(""),t=ye(),s=le(),n=re(),r=_(d=>d.auth.user),m=p.useCallback(async({pageIndex:d=z.PAGEINDEX,pageSize:f=z.PAGESIZE,textSearch:k,statusId:K,time:E=q().year().toString(),roleType:v})=>{const A={PageIndex:d.toString(),PageSize:f.toString(),UserId:r==null?void 0:r.id,RoleId:r==null?void 0:r.applicationRoles[0].id,StatusId:K,Time:`1-1-${E}`,TextSearch:k,tenant:n,roleType:v},Q=fe(A),{data:W,succeeded:C}=await t(()=>i.post(`/Goal/get-list-with-pagination?${Q}`),{loadingKey:"get-kpi"});if(C){const{items:M,totalRecords:G,pageIndex:ue,totalPages:he,totalExtend:pe}=W;s(Ie({data:M,pagination:{pageIndex:ue,totalRecords:G,totalPages:he},totalExtend:pe}))}},[t,i]),a=p.useCallback(async d=>{const f=H({...d,userSuggestId:r==null?void 0:r.id}),{data:k,succeeded:K}=await t(()=>i.post(`/Goal/add-or-update?tenant=${n}`,[{data:f}]),{loadingKey:"add-kpi"});return K?(s(be(k[0])),K):!1},[i,t]),l=p.useCallback(async d=>{const{id:f,...k}=d,K=H({...k,userSuggestId:r==null?void 0:r.id}),{data:E,succeeded:v}=await t(()=>i.post(`/Goal/add-or-update?tenant=${n}`,[{id:f,data:K}]),{loadingKey:"edit-kpi"});return v?(s(J(E[0])),v):!1},[i,t]),u=p.useCallback(async d=>{const f=d.join(","),{succeeded:k}=await t(()=>i.del(`/Goal/delete-by-ids/${f}/${r==null?void 0:r.id}?tenant=${n}`),{loadingKey:"delete-kpi"});return k?(s(Pe(d)),k):!1},[i,t]),g=p.useCallback(async d=>{const f=H({...d}),{data:k,succeeded:K}=await t(()=>i.put(`/Goal/update-status-by-id?tenant=${n}`,f),{loadingKey:"edit-status"});return K?(s(J(k)),K):!1},[i,t]),I=p.useCallback(async d=>{var E;const f=H({id:d.id,applicationUserId:(E=d.userSuggest)==null?void 0:E.id,status:w.Updated}),{data:k,succeeded:K}=await t(()=>i.put(`/Goal/update-status-by-id?tenant=${n}`,f),{loadingKey:"refuse-edit"});return K?(s(J(k)),K):!1},[i,t]),y=p.useCallback(async d=>{const{data:f,succeeded:k}=await t(()=>i.get(`/Goal/get-by-id/${d.id}?tenant=${n}`),{loadingKey:"report-kpi"});return k?(s(ke(f)),k):!1},[i,t]),x=p.useCallback(async()=>{const{data:d,succeeded:f}=await t(()=>i.get(`/GoalStatus/get-all?tenant=${n}`),{loadingKey:"status-kpi"});f&&s(Se(d))},[i,t]);return{getAllKPI:m,addKPI:a,deleteKPI:u,updateKPI:l,updateStatusKPI:g,refuseEditKPI:I,showReport:y,getAllStatusKPI:x}},De=({closeModal:i,data:t})=>{const{updateKPI:s}=N(),[n]=o.useForm(),[r]=F(["edit-kpi",!1]),m=async l=>{const u={...l,id:t.id,targetKPI:l.targetKPI.toString(),targetPoint:l.targetPoint.toString()};await s(u)&&(n.resetFields(),i())},a=()=>{i()};return p.useEffect(()=>{n.setFieldsValue(t)},[t]),c(p.Fragment,{children:[e("h3",{css:Fe,children:"Chỉnh sửa mục tiêu"}),c(o,{form:n,css:Ye,name:"edit-kpi",onFinish:m,layout:"vertical",children:[e(o.Item,{label:e("span",{css:L,children:"Tiêu chí"}),name:"criteria",rules:[{required:!0,message:"Vui lòng nhập tiêu chí!"}],children:e(T.TextArea,{placeholder:"Nhập tiêu chí"})}),c(b,{gutter:[20,0],children:[e(h,{span:12,children:e(o.Item,{label:e("span",{css:L,children:"Mục tiêu"}),name:"targetKPI",rules:[{required:!0,message:"Vui lòng nhập mục tiêu!"}],children:e(T,{size:"large",placeholder:"Nhập mục tiêu"})})}),e(h,{span:12,children:e(o.Item,{label:e("span",{css:L,children:"Điểm mục tiêu"}),name:"targetPoint",rules:[{required:!0,message:"Vui lòng nhập điểm mục tiêu!"}],children:e(T,{size:"large",placeholder:"Nhập điểm mục tiêu"})})})]}),e(o.Item,{label:e("span",{css:L,children:"Cách tính"}),name:"calculate",rules:[{required:!0,message:"Vui lòng nhập cách tính!"}],children:e(T.TextArea,{size:"large",placeholder:"Nếu vượt mục tiêu 1 khách hàng + 100 cho mỗi khách hàng. Nếu thiếu 1 khách hàng thì - 100 điểm"})}),e(b,{justify:"end",children:c(R,{children:[e(S,{onClick:a,children:"Huỷ"}),e(S,{loading:r,type:"primary",htmlType:"submit",children:"Xác nhận"})]})})]})]})},Ye={name:"1j6w3rk",styles:".ant-form-item-required::before{display:none!important;}margin-top:2rem"},Fe={name:"x2l4rd",styles:"font-weight:500;font-size:2rem;line-height:2.2rem;margin-top:2rem"},L={name:"vu4egt",styles:"font-size:1.4rem;line-height:1.6rem;font-weight:500"},Re=({closeModal:i,data:t})=>{var u,g;const{updateStatusKPI:s}=N(),[n]=F(["edit-status",!1]),{isSale:r,isSaleDirector:m}=B(),a=async()=>{var y;await s({id:t.id,applicationUserId:(y=t.userSuggest)==null?void 0:y.id,status:w.Processing})&&i()},l=r?((u=t.goalStatus)==null?void 0:u.code)!==w.Updated:m&&((g=t.goalStatus)==null?void 0:g.code)!==w.Pending;return c("div",{css:ve,children:[e("h3",{css:Ae,children:"Đồng ý chốt mục tiêu này"}),e(b,{justify:"center",children:c(R,{children:[e(S,{onClick:()=>i(),children:"Huỷ"}),e(S,{disabled:l,loading:n,type:"primary",onClick:a,children:"Xác nhận"})]})})]})},ve={name:"mjs9a",styles:"margin-top:2rem;padding:0 2rem"},Ae={name:"bmm6zl",styles:"font-size:1.8rem;line-height:2rem;text-align:center;margin-bottom:2.4rem;font-weight:500"},je=({closeModal:i,data:t})=>{var y,x;const{refuseEditKPI:s,updateStatusKPI:n}=N(),[r]=o.useForm(),[m]=F(["edit-status",!1]),{isSaleDirector:a,isSale:l}=B(),u=async d=>{var A;const{suggestEndTime:f,suggestTargetKPI:k,suggestTargetPoint:K}=d,E={id:t.id,suggestEndTime:q(f).format("DD/MM/YYYY"),suggestTargetKPI:k.toString(),suggestTargetPoint:K.toString(),applicationUserId:(A=t.userSuggest)==null?void 0:A.id,status:l?w.Request:w.Updated};await n(E)&&(r.resetFields(),i())},g=async()=>{await s(t)&&i()},I=()=>{i()};return p.useEffect(()=>{r.setFieldsValue({...t,endTime:q(t.endTime).format("DD/MM/YYYY"),suggestEndTime:null,suggestTargetKPI:null,suggestTargetPoint:null})},[t]),c(p.Fragment,{children:[e("h3",{css:Ve,children:a?"Xem đề xuất chỉnh sửa":"Đề xuất chỉnh sửa mục tiêu"}),c(o,{form:r,css:Ue,name:"edit-kpi",onFinish:u,layout:"vertical",children:[e(o.Item,{label:e("span",{css:j,children:"Thời gian kết thúc mục tiêu hiện tại"}),name:"endTime",children:e(T,{css:U,size:"large",disabled:!0})}),c(b,{gutter:[20,0],children:[e(h,{span:12,children:e(o.Item,{label:e("span",{css:j,children:"Mục tiêu hiện tại"}),name:"targetKPI",children:e(Y,{css:U,size:"large",disabled:!0})})}),e(h,{span:12,children:e(o.Item,{label:e("span",{css:j,children:"Điểm Mục tiêu hiên tại"}),name:"targetPoint",children:e(Y,{css:U,size:"large",disabled:!0})})})]}),e(o.Item,{label:e("span",{css:j,children:"Thơi gian kết thúc mục tiêu muốn chỉnh sửa"}),name:"suggestEndTime",children:e(ie,{size:"large",format:["DD/MM/YYYY"],css:U})}),c(b,{gutter:[20,0],children:[e(h,{span:12,children:e(o.Item,{label:e("span",{css:j,children:"Mục tiêu muốn chỉnh sửa"}),name:"suggestTargetKPI",rules:[{required:!0,message:"Vui lòng nhập mục tiêu muốn chỉnh sửa!"}],children:e(Y,{size:"large",css:U,placeholder:"Nhập mục tiêu muốn chỉnh sửa"})})}),e(h,{span:12,children:e(o.Item,{label:e("span",{css:j,children:"Điểm mục tiêu muốn chỉnh sửa"}),name:"suggestTargetPoint",rules:[{required:!0,message:"Vui lòng nhập điểm mục tiêu muốn chỉnh sửa!"}],children:e(Y,{size:"large",css:U,placeholder:"Nhập điểm mục tiêu muốn chỉnh sửa"})})})]}),e(b,{justify:"end",css:Me,children:c(R,{children:[e(S,{onClick:I,children:"Huỷ"}),a&&e(S,{ghost:!0,type:"primary",onClick:g,children:"Từ chối chỉnh sửa"}),e(S,{disabled:a?((y=t.goalStatus)==null?void 0:y.code)!==w.Request:((x=t.goalStatus)==null?void 0:x.code)!==w.Processing,loading:m,type:"primary",htmlType:"submit",children:"Xác nhận"})]})})]})]})},Ue={name:"snz50q",styles:".ant-form-item-required::before{display:none!important;}margin-top:2rem;padding:1rem 0"},Ve={name:"x2l4rd",styles:"font-weight:500;font-size:2rem;line-height:2.2rem;margin-top:2rem"},j={name:"vu4egt",styles:"font-size:1.4rem;line-height:1.6rem;font-weight:500"},Me={name:"akdqam",styles:"margin-top:1rem"},U={name:"1d3w5wq",styles:"width:100%"},Ge=({closeModal:i,data:t})=>{var m,a,l;const{showReport:s}=N(),n=_(u=>u.sale.kpi.report),r=()=>{i()};return p.useEffect(()=>{s(t)},[t]),c("div",{css:Xe,children:[e("h3",{css:He,children:"Báo cáo"}),c("div",{css:_e,children:[c(b,{justify:"space-between",children:[e(h,{children:"Tên người đề xuất"}),e(h,{children:`${((m=n==null?void 0:n.userSuggest)==null?void 0:m.firstName)??""} ${((a=n==null?void 0:n.userSuggest)==null?void 0:a.lastName)??""}`})]}),c(b,{justify:"space-between",children:[e(h,{children:"Tiêu chí"}),e(h,{children:n==null?void 0:n.criteria})]}),c(b,{justify:"space-between",children:[e(h,{children:"Điểm mục tiêu"}),e(h,{children:n==null?void 0:n.targetKPI})]}),c(b,{justify:"space-between",children:[e(h,{children:"Thời gian thực hiện"}),e(h,{children:`${q(n==null?void 0:n.startTime).format("DD/MM/YYYY")} - ${q(n==null?void 0:n.endTime).format("DD/MM/YYYY")}`})]}),c(b,{justify:"space-between",children:[e(h,{children:"Thực tế"}),e(h,{children:n==null?void 0:n.actualKPI})]}),c(b,{justify:"space-between",children:[e(h,{children:"Điểm thực tế"}),e(h,{children:n==null?void 0:n.actualPoint})]}),c(b,{justify:"space-between",children:[e(h,{children:"Trạng thái"}),e(h,{children:(l=n==null?void 0:n.goalStatus)==null?void 0:l.name})]}),e(b,{justify:"end",children:c(R,{css:Be,children:[e(S,{onClick:r,children:"Chia sẻ"}),e(S,{type:"primary",onClick:r,children:"Xác nhận"})]})})]})]})},Xe={name:"1dvcxr3",styles:"padding:1rem"},_e={name:"fnbsfe",styles:"display:flex;flex-direction:column;gap:1.4rem;font-weight:500"},Be={name:"akdqam",styles:"margin-top:1rem"},He={name:"tothlp",styles:"font-size:2rem;line-height:2.2rem;text-align:center;margin-bottom:2rem;font-weight:500"},Le=({closeModal:i,data:t})=>{const{updateStatusKPI:s}=N(),[n]=o.useForm(),[r]=F(["edit-status",!1]),m=async l=>{var f;const{targetKPI:u,targetPoint:g,calculate:I,criteria:y}=l,x={id:t.id,targetKPI:u.toString(),targetPoint:g.toString(),criteria:y,calculate:I,startTime:t.startTime,endTime:t.endTime,applicationUserId:(f=t.userSuggest)==null?void 0:f.id,status:w.Updated};await s(x)&&(n.resetFields(),i())},a=()=>{i()};return p.useEffect(()=>{var l,u;n.setFieldsValue({objectiveProposer:`${(l=t.userSuggest)==null?void 0:l.firstName} ${(u=t.userSuggest)==null?void 0:u.lastName}`,...t})},[t]),c(p.Fragment,{children:[e("h3",{css:Oe,children:"Điều chỉnh mục tiêu"}),c(o,{form:n,css:Ze,name:"edit-kpi",onFinish:m,layout:"vertical",children:[e(o.Item,{label:e("span",{css:X,children:"Người đề xuất mục tiêu"}),name:"objectiveProposer",children:e(T,{size:"large",disabled:!0,allowClear:!0})}),e(o.Item,{label:e("span",{css:X,children:"Tiêu chí"}),name:"criteria",rules:[{required:!0,message:"Vui lòng nhập tiêu chí!"}],children:e(T.TextArea,{placeholder:"Nhập tiêu chí",allowClear:!0})}),c(b,{gutter:[20,0],children:[e(h,{span:12,children:e(o.Item,{label:e("span",{css:X,children:"Mục tiêu"}),name:"targetKPI",rules:[{required:!0,message:"Vui lòng nhập mục tiêu!"}],children:e(T,{size:"large",placeholder:"Nhập mục tiêu",allowClear:!0})})}),e(h,{span:12,children:e(o.Item,{label:e("span",{css:X,children:"Điểm mục tiêu"}),name:"targetPoint",rules:[{required:!0,message:"Vui lòng nhập điểm mục tiêu!"}],children:e(T,{size:"large",placeholder:"Nhập điểm mục tiêu",allowClear:!0})})})]}),e(o.Item,{label:e("span",{css:X,children:"Cách tính"}),name:"calculate",rules:[{required:!0,message:"Vui lòng nhập cách tính!"}],children:e(T,{size:"large",placeholder:"Nhập cách tính",allowClear:!0})}),e(b,{justify:"end",children:c(R,{children:[e(S,{onClick:a,children:"Huỷ"}),e(S,{loading:r,type:"primary",htmlType:"submit",children:"Xác nhận"})]})})]})]})},Ze={name:"1j6w3rk",styles:".ant-form-item-required::before{display:none!important;}margin-top:2rem"},Oe={name:"x2l4rd",styles:"font-weight:500;font-size:2rem;line-height:2.2rem;margin-top:2rem"},X={name:"vu4egt",styles:"font-size:1.4rem;line-height:1.6rem;font-weight:500"},Qe=({closeModal:i})=>{const{addKPI:t}=N(),[s]=o.useForm(),[n]=F(["add-kpi",!1]),r=async a=>{const l={...a,targetKPI:a.targetKPI.toString(),targetPoint:a.targetPoint.toString(),startTime:q(a.startTime).format("DD/MM/YYYY"),endTime:q(a.endTime).format("DD/MM/YYYY")};await t(l)&&(s.resetFields(),i())},m=()=>{i()};return c(p.Fragment,{children:[e("h3",{css:Je,children:"Thêm đề xuất mục tiêu"}),c(o,{form:s,css:We,name:"add-kpi",onFinish:r,layout:"vertical",children:[e(o.Item,{label:e("span",{css:V,children:"Tiêu chí"}),name:"criteria",rules:[{required:!0,message:"Vui lòng nhập tiêu chí!"}],children:e(T.TextArea,{placeholder:"Nhập tiêu chí",allowClear:!0})}),c(b,{gutter:[20,0],children:[e(h,{span:12,children:e(o.Item,{label:e("span",{css:V,children:"Mục tiêu"}),name:"targetKPI",rules:[{required:!0,message:"Vui lòng nhập mục tiêu!"}],children:e(Y,{css:Z,size:"middle",placeholder:"Nhập mục tiêu"})})}),e(h,{span:12,children:e(o.Item,{label:e("span",{css:V,children:"Điểm mục tiêu"}),name:"targetPoint",rules:[{required:!0,message:"Vui lòng nhập điểm mục tiêu!"}],children:e(Y,{css:Z,size:"middle",placeholder:"Nhập điểm mục tiêu"})})})]}),c(b,{gutter:[20,0],children:[e(h,{span:12,children:e(o.Item,{label:e("span",{css:V,children:"Ngày bắt đầu mục tiêu"}),name:"startTime",rules:[{required:!0,message:"Vui lòng nhập ngày bắt đầu mục tiêu!"}],children:e(ie,{css:Z,format:["DD/MM/YYYY"],placeholder:"Nhập ngày bắt đầu mục tiêu"})})}),e(h,{span:12,children:e(o.Item,{label:e("span",{css:V,children:"Thời gian kết thúc"}),name:"endTime",rules:[{required:!0,message:"Vui lòng nhập thời gian kết thúc!"}],children:e(ie,{css:Z,format:["DD/MM/YYYY"],placeholder:"Nhập thời gian kết thúc"})})})]}),e(o.Item,{label:e("span",{css:V,children:"Cách tính"}),name:"calculate",rules:[{required:!0,message:"Vui lòng nhập cách tính!"}],children:e(T.TextArea,{placeholder:"Nhập cách tính",allowClear:!0})}),e(b,{justify:"end",children:c(R,{children:[e(S,{onClick:m,children:"Huỷ"}),e(S,{loading:n,type:"primary",htmlType:"submit",children:"Xác nhận"})]})})]})]})},We={name:"1mnl6b",styles:".ant-form-item-required::before{display:none!important;}margin-top:2rem;padding:1rem"},Je={name:"x2l4rd",styles:"font-weight:500;font-size:2rem;line-height:2.2rem;margin-top:2rem"},V={name:"vu4egt",styles:"font-size:1.4rem;line-height:1.6rem;font-weight:500"},Z={name:"1d3w5wq",styles:"width:100%"},et=({closeModal:i,goalIds:t})=>{const{deleteKPI:s,getAllKPI:n}=N(),r=_(I=>{var y;return(y=I.sale.kpi.pagination)==null?void 0:y.pageIndex})??0,[m]=F(["delete-kpi",!1]),a=we(),u=new URLSearchParams(a.search).get("tab");return c("div",{css:tt,children:[e("h3",{css:it,children:"Đồng ý xoá các mục tiêu đã chọn?"}),e(b,{justify:"center",children:c(R,{children:[e(S,{onClick:()=>i(),children:"Huỷ"}),e(S,{loading:m,type:"primary",danger:!0,onClick:async()=>{await s(t)&&(t.length===z.PAGESIZE&&n({pageIndex:r-1||1,pageSize:z.PAGESIZE,roleType:u}),i())},children:"Xoá"})]})})]})},tt={name:"mjs9a",styles:"margin-top:2rem;padding:0 2rem"},it={name:"bmm6zl",styles:"font-size:1.8rem;line-height:2rem;text-align:center;margin-bottom:2.4rem;font-weight:500"},nt=({closeModal:i,data:t})=>{var l,u;const{updateKPI:s}=N(),[n]=o.useForm(),[r]=F(["edit-status",!1]),m=async g=>{const{actualKPI:I,actualPoint:y}=g,x={id:t.id,actualKPI:I.toString(),actualPoint:y.toString()};await s(x)&&(n.resetFields(),i())},a=()=>{i()};return p.useEffect(()=>{n.setFieldsValue(t)},[t]),c(p.Fragment,{children:[e("h3",{css:at,children:"Cập nhất kết quả"}),c(o,{form:n,css:st,name:"edit-kpi",onFinish:m,layout:"vertical",children:[e(o.Item,{label:e("span",{css:ee,children:"Họ tên"}),children:e(T,{value:`${(l=t.userSuggest)==null?void 0:l.firstName} ${(u=t.userSuggest)==null?void 0:u.lastName}`,size:"large",disabled:!0,allowClear:!0})}),e(o.Item,{label:e("span",{css:ee,children:"Thực tế"}),name:"actualKPI",rules:[{required:!0,message:"Vui lòng nhập mục tiêu!"}],children:e(Y,{css:ae,size:"large",placeholder:"Nhập mục tiêu thực tế"})}),e(o.Item,{label:e("span",{css:ee,children:"Mục tiêu"}),name:"actualPoint",rules:[{required:!0,message:"Vui lòng nhập mục tiêu!"}],children:e(Y,{size:"large",css:ae,placeholder:"Nhập điểm thực tế"})}),e(b,{justify:"end",children:c(R,{children:[e(S,{onClick:a,children:"Huỷ"}),e(S,{loading:r,type:"primary",htmlType:"submit",children:"Xác nhận"})]})})]})]})},st={name:"1j6w3rk",styles:".ant-form-item-required::before{display:none!important;}margin-top:2rem"},at={name:"x2l4rd",styles:"font-weight:500;font-size:2rem;line-height:2.2rem;margin-top:2rem"},ee={name:"vu4egt",styles:"font-size:1.4rem;line-height:1.6rem;font-weight:500"},ae={name:"1d3w5wq",styles:"width:100%"},oe=p.createContext(void 0),de=()=>{const i=p.useContext(oe);if(!i)throw new Error("useModal must be used within a ModalProvider");return i},lt=({children:i})=>{const[t,s]=p.useState(),[n,r]=p.useState(!1),m=(l,u,g)=>{s({modalName:l,data:u,goalIds:g}),r(!0)},a=()=>{s(void 0),r(!1)};return c(oe.Provider,{value:{openModal:m,closeModal:a},children:[i,c(Ne,{width:(t==null?void 0:t.modalName)===P.FinalizeKPI||(t==null?void 0:t.modalName)===P.DeleteKPI?"38rem":(t==null?void 0:t.modalName)===P.RequestEdit?"68rem":"54rem",open:n,onCancel:a,footer:null,children:[(t==null?void 0:t.modalName)===P.EditKPI&&e(De,{closeModal:a,data:t.data}),(t==null?void 0:t.modalName)===P.AddKPI&&e(Qe,{closeModal:a}),(t==null?void 0:t.modalName)===P.FinalizeKPI&&e(Re,{closeModal:a,data:t.data}),(t==null?void 0:t.modalName)===P.RequestEdit&&e(je,{closeModal:a,data:t.data}),(t==null?void 0:t.modalName)===P.Report&&e(Ge,{closeModal:a,data:t.data}),(t==null?void 0:t.modalName)===P.ModifyKPI&&e(Le,{closeModal:a,data:t.data}),(t==null?void 0:t.modalName)===P.DeleteKPI&&e(et,{closeModal:a,goalIds:t.goalIds,data:t.data}),(t==null?void 0:t.modalName)===P.UpdateRequest&&e(nt,{closeModal:a,data:t.data})]})]})};function rt({data:i}){const{openModal:t}=de(),{formatMessage:s}=ce(),{isSale:n,isAdmin:r,isSaleDirector:m}=B(),{tab:a}=ne(),l=g=>{switch(g){case 1:t(P.EditKPI,i);break;case 4:t(P.FinalizeKPI,i);break;case 3:t(P.RequestEdit,i);break;case 6:t(P.Report,i);break;case 2:t(P.ModifyKPI,i);break;default:case 7:t(P.UpdateRequest,i);break}},u=p.useMemo(()=>{var g,I,y;return m?a===D.MySelf?[{key:1,label:s({id:"title.dropdown.kpi.editKPI"}),onClick:()=>l(1)},{key:6,label:s({id:"title.dropdown.kpi.report"}),onClick:()=>l(6)}]:((g=i==null?void 0:i.goalStatus)==null?void 0:g.code)===w.Pending?[{key:4,label:s({id:"title.dropdown.finalize"}),onClick:()=>l(4)},{key:3,label:m?"Xem đề xuất chỉnh sửa":s({id:"title.dropdown.requestEdit"}),onClick:()=>l(3)},{key:2,label:s({id:"title.dropdown.kpi.modifyKPI"}),onClick:()=>l(2)},{key:6,label:s({id:"title.dropdown.kpi.report"}),onClick:()=>l(6)}]:((I=i==null?void 0:i.goalStatus)==null?void 0:I.code)===w.Request?[{key:3,label:m?"Xem đề xuất chỉnh sửa":s({id:"title.dropdown.requestEdit"}),onClick:()=>l(3)},{key:2,label:s({id:"title.dropdown.kpi.modifyKPI"}),onClick:()=>l(2)},{key:6,label:s({id:"title.dropdown.kpi.report"}),onClick:()=>l(6)}]:[{key:2,label:s({id:"title.dropdown.kpi.modifyKPI"}),onClick:()=>l(2)},{key:6,label:s({id:"title.dropdown.kpi.report"}),onClick:()=>l(6)}]:n?((y=i==null?void 0:i.goalStatus)==null?void 0:y.code)===w.Updated?[{key:4,label:s({id:"title.dropdown.finalize"}),onClick:()=>l(4)},{key:1,label:s({id:"title.dropdown.kpi.editKPI"}),onClick:()=>l(1)},{key:6,label:s({id:"title.dropdown.kpi.report"}),onClick:()=>l(6)}]:[{key:3,label:m?"Xem đề xuất chỉnh sửa":s({id:"title.dropdown.requestEdit"}),onClick:()=>l(3)},{key:1,label:s({id:"title.dropdown.kpi.editKPI"}),onClick:()=>l(1)},{key:6,label:s({id:"title.dropdown.kpi.report"}),onClick:()=>l(6)}]:r?[{key:7,label:s({id:"title.dropdown.updateResult"}),onClick:()=>l(7)}]:[]},[m,a,i,s]);return e(Ke,{menu:{items:u},placement:"bottomRight",children:e("span",{css:ct,children:e(se,{type:"three-dot",width:16,height:18})})})}const ct={name:"1eets8k",styles:"cursor:pointer;&:hover{opacity:0.8;}"},O=[{title:e($,{id:"table.column.kpi.proposer"}),dataIndex:["userSuggest"],render:i=>`${i.firstName} ${i.lastName}`},{title:e($,{id:"table.column.kpi.criteria"}),dataIndex:"criteria",render:i=>i},{title:e($,{id:"table.column.kpi.objective"}),dataIndex:"targetKPI"},{title:e($,{id:"table.column.kpi.reality"}),dataIndex:"actualKPI"},{title:e($,{id:"table.column.targetPoint"}),dataIndex:"targetPoint"},{title:e($,{id:"table.column.kpi.implementationTime"}),dataIndex:"implementationTime",render:(i,t)=>`${q(t.startTime).format("DD/MM/YYYY")} đến ${q(t.endTime).format("DD/MM/YYYY")} `},{title:e($,{id:"table.column.kpi.calculationMethod"}),dataIndex:"calculate"},{title:e($,{id:"table.column.kpi.actualPoint"}),dataIndex:"actualPoint"},{title:"Trạng thái",align:"center",dataIndex:["goalStatus","name"],render:(i,t)=>{var n;let s;switch((n=t.goalStatus)==null?void 0:n.code){case w.Completed:case w.Updated:s="success";break;case w.Request:case w.Processing:s="info";break;case w.Failed:s="error";break;default:s="warning"}return t.goalStatus?e($e,{hasBackground:!0,type:s,children:t.goalStatus.name}):""}},{title:"",fixed:"right",width:"6%",render:(i,t)=>e(rt,{data:t})}];function te(){const{openModal:i}=de(),{getAllKPI:t,getAllStatusKPI:s}=N(),[n,r]=F(["get-kpi",!0],["status-kpi",!0]),{data:m,pagination:a,status:l,totalExtend:u}=_(C=>C.sale.kpi),{isSaleDirector:g,isSale:I}=B(),[y,x]=p.useState(),{tab:d,textSearch:f,time:k,statusId:K}=ne(),E=p.useMemo(()=>g&&d===D.MySelf?O==null?void 0:O.slice(1):O,[d,g]),v={onChange:(C,M)=>{x(M.map(G=>G.id))}},A=({textSearch:C,statusId:M,time:G})=>{t({pageIndex:(a==null?void 0:a.pageIndex)??z.PAGEINDEX,pageSize:z.PAGESIZE,textSearch:C,statusId:M,time:G,roleType:d})},Q=C=>{t({pageIndex:C,pageSize:z.PAGESIZE,roleType:d,textSearch:f?decodeURI(f).replace(/\+/g," "):void 0,time:k,statusId:K})};p.useEffect(()=>{t({pageIndex:z.PAGEINDEX,pageSize:z.PAGESIZE,roleType:d}),s()},[t,s,d]);const W=I?dt:me;return c("div",{css:ot,children:[(g||I)&&d!==D.Employee&&c(S,{onClick:()=>i(P.AddKPI),type:"primary",css:W,iconPosition:"start",size:"large",children:[e(se,{color:"#fff",width:16,height:16,type:"circle-plus"}),e("span",{children:"Thêm mục tiêu"})]}),e("div",{css:ut,children:e(Te,{onSearch:A,status:l,loadingStatus:r})}),c(b,{css:mt,justify:"space-between",align:"bottom",children:[e(h,{children:e(S,{disabled:!y,onClick:()=>i(P.DeleteKPI,void 0,y),size:"large",danger:!0,children:"Xoá mục tiêu đã chọn"})}),c(h,{children:["Tổng điểm đạt được: ",u??0]})]}),e(Ce,{rowSelection:v,columns:E,dataSource:m,loading:n,rowKey:C=>C.id,onTableChange:C=>Q(C),pagination:{current:a==null?void 0:a.pageIndex,pageSize:z.PAGESIZE,total:a==null?void 0:a.totalRecords,position:["bottomCenter"]},scroll:{x:1450}})]})}const ot={name:"bjn8wh",styles:"position:relative"},me={name:"1vjzj34",styles:"position:absolute;right:0;top:-9rem;background:#0070b8;display:flex;align-items:center;gap:0.2rem;&:hover{background:#0070b8!important;opacity:0.9;}"},dt=xe(me," top:-5rem;",""),mt={name:"5bn9ws",styles:"margin:2.4rem 0 1.4rem 0"},ut={name:"f2f29z",styles:"margin-top:2.6rem"};function wt(){const i=Ee(),t=le(),{formatMessage:s}=ce(),{isAdmin:n,isSaleDirector:r}=B(),m=re(),a=_(I=>{var y;return(y=I.sale.kpi.pagination)==null?void 0:y.totalRecords}),{tab:l}=ne(),u=[{key:n?D.Manager:D.MySelf,label:s(n?{id:"title.tab.kpi.manager"}:{id:"title.tab.kpi.my"}),children:e(te,{})},{key:D.Employee,label:s({id:"title.tab.kpi.employee"}),children:e(te,{})}],g=I=>{i(`?tab=${I}&tenant=${m}`)};return p.useEffect(()=>{l||i(`?tab=${n?D.Manager:D.MySelf}&tenant=${m}`)},[l]),p.useEffect(()=>{t(ze([{title:{vi_VN:"Sale",en_US:"Sale"}},{title:{vi_VN:"KPI",en_US:"KPI"}}]))},[t]),c(lt,{children:[e("h3",{css:pt,children:s({id:"title.document.kpi"})}),c("div",{css:ht,children:[e("span",{children:s({id:"title.document.kpi"})}),e(se,{width:8,height:8,type:"dot"}),c("span",{children:[a," ",s({id:"title.document.kpi"})]})]}),(n||r)&&e(qe,{activeKey:l,items:u,onChange:g}),!(n||r)&&e(te,{})]})}const ht={name:"1scp1f2",styles:"display:flex;align-items:center;gap:4px;font-size:1.4rem"},pt={name:"156m3vd",styles:"font-size:1.8rem;line-height:2.3rem;font-weight:600"};export{wt as default};
//# sourceMappingURL=index-BLuwZfy2.js.map
