import{e as B,f as Z,g as z,h as H,b as P,r,i as O,bz as W,P as f,k as T,bA as J,bB as Q,bC as Y,j as d,c as e,t as k,B as b,R as F,v as N,u as ee,C as D,D as te,z as ne}from"./index-D7kYuqtd.js";import{M as ae}from"./index-DbvvMLWa.js";import{F as v}from"./index-Cxldnjy_.js";import{I as y}from"./index-DAOf7p35.js";import{u as w}from"./loading.hook-B4xO64Zi.js";import{d as ie}from"./dayjs.min-SzvlDAgD.js";import{T as oe}from"./table-CK0VyuD-.js";import{S as se}from"./search-8bG-27XG.js";import{L as q}from"./locale-formatter-FZ-3y9Y2.js";import"./ExclamationCircleFilled-Bz7bDzj1.js";import"./InfoCircleFilled-CK2dnJYF.js";import"./index-DGwjM0Al.js";import"./index-DMzhYhmi.js";import"./index-BuPIgzdn.js";var I=(t=>(t.EditRelationLevel="Edit RelationLevel",t.DeleteRelationLevel="Delete RelationLevel",t.AddRelationLevel="Add RelationLevel",t))(I||{});const C=()=>{const t=B(""),n=Z(),o=z(),l=H(),i=P(s=>s.auth.user),c=r.useCallback(async({pageIndex:s=f.PAGEINDEX,pageSize:m=f.PAGESIZE,textSearch:p,statusId:u,time:A=ie().year().toString(),roleType:g})=>{const R={PageIndex:s.toString(),PageSize:m.toString(),UserId:i==null?void 0:i.id,RoleId:i==null?void 0:i.applicationRoles[0].id,StatusId:u,Time:`1-1-${A}`,TextSearch:p,tenant:l,roleType:g},E=O(R),{data:j,succeeded:V}=await n(()=>t.post(`/RelationshipLevel/get-list-with-pagination?${E}`),{loadingKey:"get-relationshipLv"});if(V){const{items:G,totalRecords:K,pageIndex:M,totalPages:X,totalExtend:_}=j;o(W({data:G,pagination:{pageIndex:M,totalRecords:K,totalPages:X},totalExtend:_}))}},[n,t]),a=r.useCallback(async s=>{const m=T({...s}),{data:p,succeeded:u}=await n(()=>t.post(`/RelationshipLevel/add-or-update?tenant=${l}`,[{data:m}]),{loadingKey:"add-realtionshipLv"});return u?(o(J(p[0])),u):!1},[t,n]),h=r.useCallback(async s=>{const m=T({...s}),{data:p,succeeded:u}=await n(()=>t.post(`/RelationshipLevel/add-or-update?tenant=${l}`,[{id:s.id,data:m}]),{loadingKey:"edit-realtionshipLv"});return u?(o(Q(p[0])),u):!1},[t,n]),L=r.useCallback(async s=>{const m=s.join(","),p=`${i==null?void 0:i.id}?tenant=${l}`,{succeeded:u}=await n(()=>t.del(`/RelationshipLevel/delete-by-ids/${m}/${p}`),{loadingKey:"delete-relationshipLv"});return u!==null&&u?(o(Y(s)),!0):!1},[t,n]);return{getAllRelationshipLv:c,addKRelationshipLv:a,deleteRelationshipLv:L,updateRelationshipLv:h}},le=({closeModal:t})=>{const[n]=v.useForm(),{addKRelationshipLv:o}=C(),[l]=w(["add-relationshipLv",!1]),i=async a=>{const h={...a,pointFrom:a.pointFrom.toString(),pointTo:a.pointTo.toString()};await o(h)&&(n.resetFields(),t())},c=()=>{t(),n.resetFields()};return d(r.Fragment,{children:[e("h3",{css:re,children:"Thêm mức độ quan hệ"}),d(v,{form:n,css:ce,name:"add-customer",onFinish:i,layout:"vertical",children:[e(v.Item,{label:e("span",{css:S,children:"Mức độ quan hệ"}),name:"code",rules:[{required:!0,message:"Vui lòng nhập mức độ quan hệ!"}],children:e(y,{placeholder:"Nhập mức độ quan hệ"})}),e(v.Item,{label:e("span",{css:S,children:"Định nghĩa"}),name:"description",rules:[{required:!0,message:"Vui lòng nhập định nghĩa!"}],children:e(y,{placeholder:"Nhập định nghĩa"})}),e(v.Item,{label:e("span",{css:S,children:"Điểm bắt đầu"}),name:"pointFrom",rules:[{required:!0,message:"Vui lòng nhập điểm bắt đầu!"}],children:e(y,{placeholder:"Nhập điểm bắt đầu"})}),e(v.Item,{label:e("span",{css:S,children:"Điểm kết thúc"}),name:"pointTo",rules:[{required:!0,message:"Vui lòng nhập điểm kết thúc!"}],children:e(y,{placeholder:"Nhập điểm kết thúc"})}),e(F,{justify:"end",children:d(k,{children:[e(b,{onClick:c,children:"Huỷ"}),e(b,{loading:l,type:"primary",htmlType:"submit",children:"Xác nhận"})]})})]})]})},re={name:"x2l4rd",styles:"font-weight:500;font-size:2rem;line-height:2.2rem;margin-top:2rem"},ce={name:"1mnl6b",styles:".ant-form-item-required::before{display:none!important;}margin-top:2rem;padding:1rem"},S={name:"vu4egt",styles:"font-size:1.4rem;line-height:1.6rem;font-weight:500"},de=({closeModal:t,relationshipLvIds:n})=>{const{deleteRelationshipLv:o,getAllRelationshipLv:l}=C(),i=P(m=>{var p;return(p=m.category.relationshipLv.pagination)==null?void 0:p.pageIndex})??0,[c]=w(["delete-relationshipLv",!1]),a=N(),L=new URLSearchParams(a.search).get("tab");return d("div",{css:he,children:[e("h3",{css:me,children:"Đồng ý xoá các mục tiêu đã chọn?"}),e(F,{justify:"center",children:d(k,{children:[e(b,{onClick:()=>t(),children:"Huỷ"}),e(b,{loading:c,type:"primary",danger:!0,onClick:async()=>{await o(n)?(l({pageIndex:i||1,pageSize:f.PAGESIZE,roleType:L}),t()):console.error("Failed to delete relationshipLv")},children:"Xoá"})]})})]})},he={name:"mjs9a",styles:"margin-top:2rem;padding:0 2rem"},me={name:"bmm6zl",styles:"font-size:1.8rem;line-height:2rem;text-align:center;margin-bottom:2.4rem;font-weight:500"},pe=({closeModal:t,data:n})=>{const[o]=v.useForm(),{updateRelationshipLv:l}=C(),[i]=w(["edit-realtionshipLv",!1]),c=async h=>{const L={...h,id:n.id,pointFrom:h.pointFrom.toString(),pointTo:h.pointTo.toString()};await l(L)&&(o.resetFields(),t())};r.useEffect(()=>{o.setFieldsValue(n)},[n]);const a=()=>{t()};return d(r.Fragment,{children:[e("h3",{css:ue,children:"Chỉnh sửa mức độ quan hệ"}),d(v,{form:o,css:ge,name:"add-customer",onFinish:c,layout:"vertical",children:[e(v.Item,{label:e("span",{css:x,children:"Mức độ quan hệ"}),name:"code",rules:[{required:!0,message:"Vui lòng nhập mức độ quan hệ!"}],children:e(y,{placeholder:"Nhập mức độ quan hệ"})}),e(v.Item,{label:e("span",{css:x,children:"Định nghĩa"}),name:"description",rules:[{required:!0,message:"Vui lòng nhập định nghĩa!"}],children:e(y,{placeholder:"Nhập định nghĩa"})}),e(v.Item,{label:e("span",{css:x,children:"Điểm bắt đầu"}),name:"pointFrom",rules:[{required:!0,message:"Vui lòng nhập điểm bắt đầu!"}],children:e(y,{placeholder:"Nhập điểm bắt đầu"})}),e(v.Item,{label:e("span",{css:x,children:"Điểm kết thúc"}),name:"pointTo",rules:[{required:!0,message:"Vui lòng nhập điểm kết thúc!"}],children:e(y,{placeholder:"Nhập điểm kết thúc"})}),e(F,{justify:"end",children:d(k,{children:[e(b,{onClick:a,children:"Huỷ"}),e(b,{loading:i,type:"primary",htmlType:"submit",children:"Xác nhận"})]})})]})]})},ue={name:"x2l4rd",styles:"font-weight:500;font-size:2rem;line-height:2.2rem;margin-top:2rem"},ge={name:"1mnl6b",styles:".ant-form-item-required::before{display:none!important;}margin-top:2rem;padding:1rem"},x={name:"vu4egt",styles:"font-size:1.4rem;line-height:1.6rem;font-weight:500"},U=r.createContext(void 0),$=()=>{const t=r.useContext(U);if(!t)throw new Error("useModalRelationshipLv must be used within a ModalRelationshipLvProvider");return t},ve=({children:t})=>{const[n,o]=r.useState(),[l,i]=r.useState(!1),c=(h,L,s)=>{o({modalName:h,data:L,relationshipLvIds:s}),i(!0)},a=()=>{o(void 0),i(!1)};return d(U.Provider,{value:{openModal:c,closeModal:a},children:[t,d(ae,{open:l,onCancel:a,footer:null,children:[(n==null?void 0:n.modalName)===I.EditRelationLevel&&e(pe,{closeModal:a,data:n.data}),(n==null?void 0:n.modalName)===I.DeleteRelationLevel&&e(de,{closeModal:a,data:n.data,relationshipLvIds:n.relationshipLvIds}),(n==null?void 0:n.modalName)===I.AddRelationLevel&&e(le,{closeModal:a})]})]})};function Le({data:t}){const{openModal:n}=$(),{formatMessage:o}=ee(),l=c=>{switch(c){case 1:n(I.EditRelationLevel,t);break}},i=[{key:"1",label:e("span",{children:o({id:"dropdown.edit"})}),onClick:()=>l(1)}];return e(te,{menu:{items:i},placement:"bottomRight",children:e(b,{css:fe,children:e(D,{type:"three-dot",width:16,height:18})})})}const fe={name:"l2srbf",styles:"background:none;border:none;box-shadow:unset;padding:0"},be=[{title:e(q,{id:"table.column.relationshipLvCode"}),dataIndex:"code",render:t=>t},{title:e(q,{id:"table.column.relationshipLvDesc"}),dataIndex:"description",render:t=>t},{title:"",dataIndex:"calculationMethod",fixed:"right",width:"6%",render:(t,n)=>e(Le,{data:n})}];function ye(){const[t,n]=r.useState(),{openModal:o}=$(),{getAllRelationshipLv:l}=C(),[i]=w(["get-relationshipLv",!0]),{data:c,pagination:a}=P(g=>g.category.relationshipLv),h=N(),s=new URLSearchParams(h.search).get("tab"),m=({textSearch:g,time:R})=>{l({pageIndex:(a==null?void 0:a.pageIndex)??f.PAGEINDEX,pageSize:f.PAGESIZE,textSearch:g,time:R,roleType:s})},p=g=>{l({pageIndex:g,pageSize:f.PAGESIZE,roleType:s})},u={onChange:(g,R)=>{n(R.map(E=>E.id))}},A=()=>{o("Delete RelationLevel",void 0,t)};return r.useEffect(()=>{l({pageIndex:f.PAGEINDEX,pageSize:f.PAGESIZE,roleType:s})},[l,s]),d("div",{css:Re,children:[d(b,{onClick:()=>o("Add RelationLevel"),type:"primary",css:Ie,iconPosition:"start",size:"large",children:[e(D,{color:"#fff",width:16,height:16,type:"circle-plus"}),e("span",{children:"Thêm mức độ quan hệ"})]}),e("div",{css:Se,children:e(se,{onSearch:m})}),e("div",{css:xe,children:e(b,{disabled:!t,onClick:()=>A(),size:"large",danger:!0,children:"Xoá mục tiêu đã chọn"})}),e(oe,{rowSelection:u,columns:be,dataSource:c,loading:i,rowKey:g=>g.id,onTableChange:g=>p(g),pagination:{current:a==null?void 0:a.pageIndex,pageSize:f.PAGESIZE,total:a==null?void 0:a.totalRecords,position:["bottomCenter"]},scroll:{x:1450}})]})}const Re={name:"bjn8wh",styles:"position:relative"},Ie={name:"ngm6dc",styles:"position:absolute;right:0;top:-6.5rem;background:#0070b8;display:flex;align-items:center;gap:0.2rem;&:hover{background:#0070b8!important;opacity:0.9;}"},Se={name:"f2f29z",styles:"margin-top:2.6rem"},xe={name:"vj2mbl",styles:"margin:1.1rem 0"};function Ve(){const t=z();return r.useEffect(()=>{t(ne([{title:{vi_VN:"Danh mục",en_US:"Category"}},{title:{vi_VN:"Mức độ quan hệ",en_US:"Relationship level"}}]))},[t]),d(ve,{children:[e("h3",{css:we,children:"Mức độ quan hệ"}),e(ye,{})]})}const we={name:"9czw1u",styles:"font-size:2.4rem;line-height:2.8rem;font-weight:600;color:rgba(16, 24, 40, 1);margin-bottom:0.5rem"};export{Ve as default};
//# sourceMappingURL=index-TJXhcwbM.js.map
