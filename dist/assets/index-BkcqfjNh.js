import{e as M,f as Z,g as F,h as B,b as q,r as c,i as H,bD as O,P as b,k as N,bE as W,bF as J,bG as Y,j as l,c as e,t as v,B as G,R as k,v as T,u as ee,C as D,D as te,z as ne}from"./index-D7kYuqtd.js";import{M as se}from"./index-DbvvMLWa.js";import{F as f}from"./index-Cxldnjy_.js";import{I}from"./index-DAOf7p35.js";import{u as C}from"./loading.hook-B4xO64Zi.js";import{d as ae}from"./dayjs.min-SzvlDAgD.js";import{T as ie}from"./table-CK0VyuD-.js";import{S as oe}from"./search-8bG-27XG.js";import{L as z}from"./locale-formatter-FZ-3y9Y2.js";import"./ExclamationCircleFilled-Bz7bDzj1.js";import"./InfoCircleFilled-CK2dnJYF.js";import"./index-DGwjM0Al.js";import"./index-DMzhYhmi.js";import"./index-BuPIgzdn.js";var S=(t=>(t.EditQuestion="Edit Question",t.DeleteQuestion="Delete Question",t.AddQuestion="Add Question",t))(S||{});const x=()=>{const t=M(""),n=Z(),i=F(),r=B(),a=q(o=>o.auth.user),d=c.useCallback(async({pageIndex:o=b.PAGEINDEX,pageSize:u=b.PAGESIZE,textSearch:m,statusId:h,time:w=ae().year().toString(),roleType:p})=>{const Q={PageIndex:o.toString(),PageSize:u.toString(),UserId:a==null?void 0:a.id,RoleId:a==null?void 0:a.applicationRoles[0].id,StatusId:h,Time:`1-1-${w}`,TextSearch:m,tenant:r,roleType:p},A=H(Q),{data:$,succeeded:j}=await n(()=>t.post(`/GainsQuestion/get-list-with-pagination?${A}`),{loadingKey:"get-questionGain"});if(j){const{items:L,totalRecords:V,pageIndex:X,totalPages:_,totalExtend:K}=$;i(O({data:L,pagination:{pageIndex:X,totalRecords:V,totalPages:_},totalExtend:K}))}},[n,t]),s=c.useCallback(async o=>{const u=N({...o}),{data:m,succeeded:h}=await n(()=>t.post(`/GainsQuestion/add-or-update?tenant=${r}`,[{data:u}]),{loadingKey:"add-questionGain"});return h?(i(W(m[0])),h):!1},[t,n]),g=c.useCallback(async o=>{const u=o.join(","),m=`${a==null?void 0:a.id}?tenant=${r}`,{succeeded:h}=await n(()=>t.del(`/GainsQuestion/delete-by-ids/${u}/${m}`),{loadingKey:"delete-questionGain"});return h!==null&&h?(i(J(o)),!0):!1},[t,n]),y=c.useCallback(async o=>{const u=N({...o}),{data:m,succeeded:h}=await n(()=>t.post(`/GainsQuestion/add-or-update?tenant=${r}`,[{id:o.id,data:u}]),{loadingKey:"edit-questionGain"});return h?(i(Y(m[0])),h):!1},[t,n]);return{getAllQuestionGain:d,addQuestionGain:s,deleteQuestionGain:g,updateQuestionGain:y}},re=({closeModal:t})=>{const[n]=f.useForm(),{addQuestionGain:i}=x(),[r]=C(["add-questionGain",!1]),a=async s=>{const g={...s,code:s.code.toString()};await i(g)&&(n.resetFields(),t())},d=()=>{t(),n.resetFields()};return l(c.Fragment,{children:[e("h3",{css:ce,children:"Thêm câu hỏi bằng GAIN"}),l(f,{form:n,css:de,name:"add-questionGain",onFinish:a,layout:"vertical",children:[e(f.Item,{label:e("span",{css:E,children:"Số thứ tự"}),name:"code",rules:[{required:!1,message:"Vui lòng nhập số thứ tự!"}],children:e(I,{placeholder:"Nhập số thứ tự"})}),e(f.Item,{label:e("span",{css:E,children:"Câu hỏi"}),name:"content",rules:[{required:!0,message:"Vui lòng nhập câu hỏi!"}],children:e(I,{placeholder:"Nhập tên câu hỏi"})}),e(f.Item,{label:e("span",{css:E,children:"Mô tả"}),name:"description",rules:[{required:!1,message:"Vui lòng nhập mô tả!"}],children:e(I,{placeholder:"Nhập mô tả"})}),e(k,{justify:"end",children:l(v,{children:[e(G,{onClick:d,children:"Huỷ"}),e(G,{loading:r,type:"primary",htmlType:"submit",children:"Xác nhận"})]})})]})]})},ce={name:"x2l4rd",styles:"font-weight:500;font-size:2rem;line-height:2.2rem;margin-top:2rem"},de={name:"1mnl6b",styles:".ant-form-item-required::before{display:none!important;}margin-top:2rem;padding:1rem"},E={name:"vu4egt",styles:"font-size:1.4rem;line-height:1.6rem;font-weight:500"},le=({closeModal:t,questionIds:n})=>{const{deleteQuestionGain:i,getAllQuestionGain:r}=x(),a=q(u=>{var m;return(m=u.category.questionGain.pagination)==null?void 0:m.pageIndex})??0,[d]=C(["delete-questionGain",!1]),s=T(),y=new URLSearchParams(s.search).get("tab");return l("div",{css:ue,children:[e("h3",{css:me,children:"Đồng ý xoá các mục tiêu đã chọn?"}),e(k,{justify:"center",children:l(v,{children:[e(G,{onClick:()=>t(),children:"Huỷ"}),e(G,{loading:d,type:"primary",danger:!0,onClick:async()=>{await i(n)?(r({pageIndex:a||1,pageSize:b.PAGESIZE,roleType:y}),t()):console.error("Failed to delete question")},children:"Xoá"})]})})]})},ue={name:"mjs9a",styles:"margin-top:2rem;padding:0 2rem"},me={name:"bmm6zl",styles:"font-size:1.8rem;line-height:2rem;text-align:center;margin-bottom:2.4rem;font-weight:500"},he=({closeModal:t,data:n})=>{const[i]=f.useForm(),{updateQuestionGain:r}=x(),[a]=C(["edit-questionGain",!1]),d=async g=>{const y={...g,id:n.id,code:g.code.toString()};await r(y)&&(i.resetFields(),t())},s=()=>{t()};return c.useEffect(()=>{i.setFieldsValue(n)},[n]),l(c.Fragment,{children:[e("h3",{css:pe,children:"Thêm câu hỏi bằng GAIN"}),l(f,{form:i,css:ge,name:"add-questionGain",onFinish:d,layout:"vertical",children:[e(f.Item,{label:e("span",{css:P,children:"Số thứ tự"}),name:"code",rules:[{required:!1,message:"Vui lòng nhập số thứ tự!"}],children:e(I,{placeholder:"Nhập số thứ tự",disabled:!0})}),e(f.Item,{label:e("span",{css:P,children:"Câu hỏi"}),name:"content",rules:[{required:!0,message:"Vui lòng nhập câu hỏi!"}],children:e(I,{placeholder:"Nhập tên câu hỏi"})}),e(f.Item,{label:e("span",{css:P,children:"Mô tả"}),name:"description",rules:[{required:!1,message:"Vui lòng nhập mô tả!"}],children:e(I,{placeholder:"Nhập mô tả"})}),e(k,{justify:"end",children:l(v,{children:[e(G,{onClick:s,children:"Huỷ"}),e(G,{loading:a,type:"primary",htmlType:"submit",children:"Xác nhận"})]})})]})]})},pe={name:"x2l4rd",styles:"font-weight:500;font-size:2rem;line-height:2.2rem;margin-top:2rem"},ge={name:"1mnl6b",styles:".ant-form-item-required::before{display:none!important;}margin-top:2rem;padding:1rem"},P={name:"vu4egt",styles:"font-size:1.4rem;line-height:1.6rem;font-weight:500"},R=c.createContext(void 0),U=()=>{const t=c.useContext(R);if(!t)throw new Error("useModalQuestionGains must be used within a ModalQuestionGainsProvider");return t},fe=({children:t})=>{const[n,i]=c.useState(),[r,a]=c.useState(!1),d=(g,y,o)=>{i({modalName:g,data:y,questionIds:o}),a(!0)},s=()=>{i(void 0),a(!1)};return l(R.Provider,{value:{openModal:d,closeModal:s},children:[t,l(se,{open:r,onCancel:s,footer:null,children:[(n==null?void 0:n.modalName)===S.EditQuestion&&e(he,{closeModal:s,data:n.data}),(n==null?void 0:n.modalName)===S.DeleteQuestion&&e(le,{closeModal:s,data:n.data,questionIds:n.questionIds}),(n==null?void 0:n.modalName)===S.AddQuestion&&e(re,{closeModal:s})]})]})};function ye({data:t}){const{openModal:n}=U(),{formatMessage:i}=ee(),r=d=>{switch(d){case 1:n(S.EditQuestion,t);break}},a=[{key:"1",label:e("span",{children:i({id:"dropdown.edit"})}),onClick:()=>r(1)}];return e(te,{menu:{items:a},placement:"bottomRight",children:e(G,{css:be,children:e(D,{type:"three-dot",width:16,height:18})})})}const be={name:"l2srbf",styles:"background:none;border:none;box-shadow:unset;padding:0"},Ge=[{title:e(z,{id:"table.column.questionGainsCode"}),dataIndex:"code",render:t=>t},{title:e(z,{id:"table.column.questionGainsQuestion"}),dataIndex:"content",render:t=>t},{title:"",dataIndex:"calculationMethod",fixed:"right",width:"6%",render:(t,n)=>e(ye,{data:n})}];function Ie(){const[t,n]=c.useState(),{openModal:i}=U(),{getAllQuestionGain:r}=x(),[a]=C(["get-questionGain",!0]),{data:d,pagination:s}=q(p=>p.category.questionGain),g=T(),o=new URLSearchParams(g.search).get("tab"),u=({textSearch:p,time:Q})=>{r({pageIndex:(s==null?void 0:s.pageIndex)??b.PAGEINDEX,pageSize:b.PAGESIZE,textSearch:p,time:Q,roleType:o})},m=p=>{r({pageIndex:p,pageSize:b.PAGESIZE,roleType:o})},h={onChange:(p,Q)=>{n(Q.map(A=>A.id))}},w=()=>{i("Delete Question",void 0,t)};return c.useEffect(()=>{r({pageIndex:b.PAGEINDEX,pageSize:b.PAGESIZE,roleType:o})},[r,o]),l("div",{css:Qe,children:[l(G,{onClick:()=>i("Add Question"),type:"primary",css:Se,iconPosition:"start",size:"large",children:[e(D,{color:"#fff",width:16,height:16,type:"circle-plus"}),e("span",{children:"Thêm câu hỏi"})]}),e("div",{css:Ce,children:e(oe,{onSearch:u})}),e("div",{css:xe,children:e(G,{disabled:!t,onClick:()=>w(),size:"large",danger:!0,children:"Xoá mục tiêu đã chọn"})}),e(ie,{rowSelection:h,columns:Ge,dataSource:d,loading:a,rowKey:p=>p.id,onTableChange:p=>m(p),pagination:{current:s==null?void 0:s.pageIndex,pageSize:b.PAGESIZE,total:s==null?void 0:s.totalRecords,position:["bottomCenter"]},scroll:{x:1450}})]})}const Qe={name:"bjn8wh",styles:"position:relative"},Se={name:"ngm6dc",styles:"position:absolute;right:0;top:-6.5rem;background:#0070b8;display:flex;align-items:center;gap:0.2rem;&:hover{background:#0070b8!important;opacity:0.9;}"},Ce={name:"f2f29z",styles:"margin-top:2.6rem"},xe={name:"vj2mbl",styles:"margin:1.1rem 0"};function je(){const t=F();return c.useEffect(()=>{t(ne([{title:{vi_VN:"Danh mục",en_US:"Category"}},{title:{vi_VN:"Câu hỏi bằng GAINS",en_US:"Questions using GAINS"}}]))},[t]),l(fe,{children:[e("h3",{css:we,children:"Câu hỏi bảng GAIN"}),e(Ie,{})]})}const we={name:"9czw1u",styles:"font-size:2.4rem;line-height:2.8rem;font-weight:600;color:rgba(16, 24, 40, 1);margin-bottom:0.5rem"};export{je as default};
//# sourceMappingURL=index-BkcqfjNh.js.map
