import{M as Y}from"./index-B85xVXIU.js";import{t as z,m as b,c as A,r as u,n as o,o as e,O as E,S as q,B as g,R as C,I as F,P as M,C as P,e as T}from"./index-Bakn7Zu-.js";import{F as d}from"./index-BxD5BTBy.js";import{u as w}from"./opportunity.service-Ce2J1PJa.js";import{D as U}from"./index-s-JRt1VF.js";import{T as B}from"./index-DlE2oBel.js";var O=(r=>(r.AssignOpportunity="Assign Opportunity",r.CreateHistoryOpportunity="Create History Opportunity",r.CloseOpportunity="Close Opportunity",r.Delete="Delete",r))(O||{});const X=({...r})=>{const{closeModal:t,data:c}=r,{formatMessage:n}=z(),{getAllSaleAndSupplier:a,assignSaleAndSupplier:m}=w(),[s]=d.useForm(),[y]=b(["getAllSaleAndSupplier-opportunity",!1]),i=A(h=>h.sale.opportunity.saleAndSupplier),l=u.useMemo(()=>i==null?void 0:i.map(h=>({label:h.userName,value:h.id})),[i]),f=()=>{},S=async h=>{const D={id:c.id,saleAndSupplierId:h.saleAndSupplierId};await m(D)&&(s.resetFields(),t())},p=()=>{t()};return u.useEffect(()=>{a()},[a]),o(u.Fragment,{children:[e("h3",{css:G,children:"Gán cơ hội cho Sale/NPP"}),o(d,{form:s,css:$,name:"assign-opportunity",onFinish:S,layout:"vertical",children:[e(d.Item,{label:e("span",{css:R,children:n({id:"title.form.select"})}),name:"saleAndSupplierId",rules:[{required:!0,message:n({id:"form.input.require.selectCustomer"})}],children:e(E,{size:"large",placeholder:n({id:"title.form.selectCustomer"}),onChange:f,allowClear:!0,loading:y,options:l})}),e(C,{justify:"end",children:o(q,{children:[e(g,{onClick:p,children:"Huỷ"}),e(g,{type:"primary",htmlType:"submit",children:"Xác nhận"})]})})]})]})},$={name:"snz50q",styles:".ant-form-item-required::before{display:none!important;}margin-top:2rem;padding:1rem 0"},G={name:"x2l4rd",styles:"font-weight:500;font-size:2rem;line-height:2.2rem;margin-top:2rem"},R={name:"1pi3rvi",styles:"font-size:1.4rem;line-height:1.6rem;font-weight:500;color:rgba(16, 24, 40, 1)"},L=({...r})=>{const{closeModal:t,data:c}=r,{formatMessage:n}=z(),{getAllSaleAndSupplier:a,updateStatusOpportunityById:m}=w(),[s]=d.useForm(),[y]=b(["edit-statusOpportunityById",!1]),i=A(p=>p.sale.opportunity.status),l=u.useMemo(()=>i==null?void 0:i.map(p=>({label:p.name,value:p.id})),[i]),f=async p=>{var v,H;const h={id:c.id,applicationUserId:(v=c.applicationUser)==null?void 0:v.id,status:(H=i==null?void 0:i.find(j=>j.id===p.status))==null?void 0:H.code,reason:p.reason};await m(h)&&(s.resetFields(),t())},S=()=>{t()};return u.useEffect(()=>{a()},[a]),o(u.Fragment,{children:[e("h3",{css:W,children:"Đóng cơ hội"}),o(d,{form:s,css:Z,name:"close-opportunity",onFinish:f,layout:"vertical",children:[e(d.Item,{label:e("span",{css:k,children:n({id:"title.form.selectStatus"})}),name:"status",rules:[{required:!0,message:n({id:"form.input.require.selectStatus"})}],children:e(E,{size:"large",placeholder:n({id:"title.form.selectStatus"}),allowClear:!0,loading:y,options:l})}),e(d.Item,{label:e("span",{css:k,children:n({id:"title.form.reason"})}),name:"reason",rules:[{required:!0,message:n({id:"form.input.require.reason"})}],children:e(F.TextArea,{style:{resize:"none"},placeholder:n({id:"form.input.reason"})})}),e(C,{justify:"end",children:o(q,{children:[e(g,{onClick:S,children:"Huỷ"}),e(g,{type:"primary",htmlType:"submit",children:"Xác nhận"})]})})]})]})},Z={name:"snz50q",styles:".ant-form-item-required::before{display:none!important;}margin-top:2rem;padding:1rem 0"},W={name:"x2l4rd",styles:"font-weight:500;font-size:2rem;line-height:2.2rem;margin-top:2rem"},k={name:"1pi3rvi",styles:"font-size:1.4rem;line-height:1.6rem;font-weight:500;color:rgba(16, 24, 40, 1)"},J=({closeModal:r,opportunityIds:t,data:c})=>{const{deleteOpportunity:n,getAllOpportunity:a}=w(),m=A(i=>{var l;return(l=i.sale.kpi.pagination)==null?void 0:l.pageIndex})??0,[s]=b(["delete-opportunity",!1]);return o("div",{css:K,children:[e("h3",{css:Q,children:"Đồng ý xoá cơ hội đã chọn?"}),e(C,{justify:"center",children:o(q,{children:[e(g,{onClick:()=>r(),children:"Huỷ"}),e(g,{loading:s,type:"primary",danger:!0,onClick:async()=>{await n(c?[c.id]:t)&&(r(),t.length===M.PAGESIZE&&a({pageIndex:m-1||1,pageSize:M.PAGESIZE}))},children:"Xoá"})]})})]})},K={name:"mjs9a",styles:"margin-top:2rem;padding:0 2rem"},Q={name:"bmm6zl",styles:"font-size:1.8rem;line-height:2rem;text-align:center;margin-bottom:2.4rem;font-weight:500"},V=({closeModal:r,data:t})=>{const{addHistoryOpportunity:c}=w(),{formatMessage:n}=z(),[a]=d.useForm(),m=A(l=>l.auth.user),[s]=b(["add-Opportunity",!1]),y=async l=>{const{goal:f,time:S}=l,p={...l,time:T(S).format("DD/MM/YYYY"),goal:f.toString(),opportunityId:t.id,applicationUserId:m==null?void 0:m.id};await c(p)&&(a.resetFields(),r())},i=()=>{r()};return o(u.Fragment,{children:[e("h3",{css:ee,children:"Thêm cập nhật cơ hội"}),o(d,{form:a,css:_,name:"add-historyOpportunity",onFinish:y,layout:"vertical",children:[e(d.Item,{label:e("span",{css:I,children:n({id:"title.form.target"})}),name:"goal",rules:[{required:!0,message:n({id:"form.input.require.target"})}],children:e(B,{css:x,size:"large",placeholder:n({id:"form.input.target"})})}),e(d.Item,{label:e("span",{css:I,children:n({id:"title.form.activity"})}),name:"activity",rules:[{required:!0,message:n({id:"form.input.require.activity"})}],children:e(F.TextArea,{placeholder:n({id:"form.input.activity"}),allowClear:!0})}),o(C,{gutter:[20,0],children:[e(P,{span:12,children:e(d.Item,{label:e("span",{css:I,children:n({id:"title.form.time"})}),name:"time",rules:[{required:!0,message:n({id:"form.input.require.time"})}],children:e(U,{size:"large",css:x,format:["DD/MM/YYYY"],placeholder:"Nhập thời điểm"})})}),e(P,{span:12,children:e(d.Item,{label:e("span",{css:I,children:n({id:"title.form.result"})}),name:"result",rules:[{required:!0,message:n({id:"form.input.require.result"})}],children:e(F,{css:x,size:"large",placeholder:"Nhập kết quả"})})})]}),e(C,{justify:"end",css:te,children:o(q,{children:[e(g,{onClick:i,children:"Huỷ"}),e(g,{loading:s,type:"primary",htmlType:"submit",children:"Xác nhận"})]})})]})]})},_={name:"1mnl6b",styles:".ant-form-item-required::before{display:none!important;}margin-top:2rem;padding:1rem"},ee={name:"x2l4rd",styles:"font-weight:500;font-size:2rem;line-height:2.2rem;margin-top:2rem"},I={name:"vu4egt",styles:"font-size:1.4rem;line-height:1.6rem;font-weight:500"},x={name:"1d3w5wq",styles:"width:100%"},te={name:"akdqam",styles:"margin-top:1rem"},N=u.createContext(void 0),le=()=>{const r=u.useContext(N);if(!r)throw new Error("useOpportunityModal must be used within a ModalOpportunityProvider");return r},de=({children:r})=>{const[t,c]=u.useState(),[n,a]=u.useState(!1),m=(y,i,l)=>{c({modalName:y,data:i,opportunityIds:l}),a(!0)},s=()=>{c(void 0),a(!1)};return o(N.Provider,{value:{openModal:m,closeModal:s},children:[r,o(Y,{open:n,onCancel:s,footer:null,children:[(t==null?void 0:t.modalName)===O.AssignOpportunity&&e(X,{closeModal:s,data:t.data}),(t==null?void 0:t.modalName)===O.CloseOpportunity&&e(L,{closeModal:s,data:t.data}),(t==null?void 0:t.modalName)===O.Delete&&e(J,{closeModal:s,data:t.data,opportunityIds:t.opportunityIds}),(t==null?void 0:t.modalName)===O.CreateHistoryOpportunity&&e(V,{closeModal:s,data:t.data})]})]})};export{O as M,de as a,le as u};
//# sourceMappingURL=index-EKr7IYs7.js.map
